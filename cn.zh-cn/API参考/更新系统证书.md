# 更新系统证书<a name="apig-phapi-180911227"></a>

## 功能介绍<a name="section173482301428"></a>

更新指定的系统证书。

>![](public_sys-resources/icon-note.gif) **说明：**   
>为了安全起见，在服务器上使用curl命令调用接口查询信息后，需要清理历史操作记录，包括但不限于“\~/.bash\_history”、“/var/log/messages”（如有）。  

## URI<a name="section1336323014423"></a>

HTTP/HTTPS请求方法以及URI如下表所示。

**表 1**  HTTP/HTTPS请求方法以及URI

<a name="table1439319294431"></a>
<table><thead align="left"><tr id="row1393229154314"><th class="cellrowborder" valign="top" width="32.07%" id="mcps1.2.3.1.1"><p id="p14361448204314"><a name="p14361448204314"></a><a name="p14361448204314"></a>请求方法</p>
</th>
<th class="cellrowborder" valign="top" width="67.93%" id="mcps1.2.3.1.2"><p id="p1936174864316"><a name="p1936174864316"></a><a name="p1936174864316"></a>URI</p>
</th>
</tr>
</thead>
<tbody><tr id="row8393122914436"><td class="cellrowborder" valign="top" width="32.07%" headers="mcps1.2.3.1.1 "><p id="p1236111482435"><a name="p1236111482435"></a><a name="p1236111482435"></a>PUT</p>
</td>
<td class="cellrowborder" valign="top" width="67.93%" headers="mcps1.2.3.1.2 "><p id="p11361848184318"><a name="p11361848184318"></a><a name="p11361848184318"></a>/v1/{project_id}/apigw/instances/{instance_id}/certificates/{id}</p>
</td>
</tr>
</tbody>
</table>

URI中的参数说明如下表所示。

**表 2**  参数说明

<a name="table18784710"></a>
<table><thead align="left"><tr id="row37287554"><th class="cellrowborder" valign="top" width="24.48755124487551%" id="mcps1.2.5.1.1"><p id="p393051"><a name="p393051"></a><a name="p393051"></a>名称</p>
</th>
<th class="cellrowborder" valign="top" width="17.348265173482652%" id="mcps1.2.5.1.2"><p id="p31837140"><a name="p31837140"></a><a name="p31837140"></a>是否必选</p>
</th>
<th class="cellrowborder" valign="top" width="15.308469153084694%" id="mcps1.2.5.1.3"><p id="p28671509"><a name="p28671509"></a><a name="p28671509"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="42.85571442855714%" id="mcps1.2.5.1.4"><p id="p40690887"><a name="p40690887"></a><a name="p40690887"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row1871116301239"><td class="cellrowborder" valign="top" width="24.48755124487551%" headers="mcps1.2.5.1.1 "><p id="p55878963"><a name="p55878963"></a><a name="p55878963"></a>project_id</p>
</td>
<td class="cellrowborder" valign="top" width="17.348265173482652%" headers="mcps1.2.5.1.2 "><p id="p29902160"><a name="p29902160"></a><a name="p29902160"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="15.308469153084694%" headers="mcps1.2.5.1.3 "><p id="p6155914"><a name="p6155914"></a><a name="p6155914"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="42.85571442855714%" headers="mcps1.2.5.1.4 "><p id="p28867016"><a name="p28867016"></a><a name="p28867016"></a>项目ID。可从控制台“我的凭证”中获取region下项目ID，管理员权限可查询。</p>
</td>
</tr>
<tr id="row17239143015311"><td class="cellrowborder" valign="top" width="24.48755124487551%" headers="mcps1.2.5.1.1 "><p id="p1780913159538"><a name="p1780913159538"></a><a name="p1780913159538"></a>instance_id</p>
</td>
<td class="cellrowborder" valign="top" width="17.348265173482652%" headers="mcps1.2.5.1.2 "><p id="p9809215115310"><a name="p9809215115310"></a><a name="p9809215115310"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="15.308469153084694%" headers="mcps1.2.5.1.3 "><p id="p1280914152538"><a name="p1280914152538"></a><a name="p1280914152538"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="42.85571442855714%" headers="mcps1.2.5.1.4 "><p id="p1880914157537"><a name="p1880914157537"></a><a name="p1880914157537"></a>实例ID，可从API网关控制台的专享版实例信息中获取。</p>
</td>
</tr>
<tr id="row7627537"><td class="cellrowborder" valign="top" width="24.48755124487551%" headers="mcps1.2.5.1.1 "><p id="p13850780"><a name="p13850780"></a><a name="p13850780"></a>id</p>
</td>
<td class="cellrowborder" valign="top" width="17.348265173482652%" headers="mcps1.2.5.1.2 "><p id="p48171408"><a name="p48171408"></a><a name="p48171408"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="15.308469153084694%" headers="mcps1.2.5.1.3 "><p id="p9569939"><a name="p9569939"></a><a name="p9569939"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="42.85571442855714%" headers="mcps1.2.5.1.4 "><p id="p36967632"><a name="p36967632"></a><a name="p36967632"></a>证书的编号。</p>
</td>
</tr>
</tbody>
</table>

## 请求消息<a name="section20801952879"></a>

**表 3**  参数说明

<a name="table10951452273"></a>
<table><thead align="left"><tr id="row31110522712"><th class="cellrowborder" valign="top" width="15.46154615461546%" id="mcps1.2.5.1.1"><p id="p14111135219713"><a name="p14111135219713"></a><a name="p14111135219713"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="13.4013401340134%" id="mcps1.2.5.1.2"><p id="p1411155210712"><a name="p1411155210712"></a><a name="p1411155210712"></a>是否必选</p>
</th>
<th class="cellrowborder" valign="top" width="13.4013401340134%" id="mcps1.2.5.1.3"><p id="p511120521571"><a name="p511120521571"></a><a name="p511120521571"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="57.73577357735774%" id="mcps1.2.5.1.4"><p id="p11111115216712"><a name="p11111115216712"></a><a name="p11111115216712"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row13127175218712"><td class="cellrowborder" valign="top" width="15.46154615461546%" headers="mcps1.2.5.1.1 "><p id="p2127155217718"><a name="p2127155217718"></a><a name="p2127155217718"></a>domain_name</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.2 "><p id="p61271452776"><a name="p61271452776"></a><a name="p61271452776"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.3 "><p id="p151273523715"><a name="p151273523715"></a><a name="p151273523715"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="57.73577357735774%" headers="mcps1.2.5.1.4 "><p id="p51278521777"><a name="p51278521777"></a><a name="p51278521777"></a>域名</p>
<p id="p14127125210718"><a name="p14127125210718"></a><a name="p14127125210718"></a>长度为0-255位的字符串，需要符合域名规范。</p>
</td>
</tr>
<tr id="row212713521476"><td class="cellrowborder" valign="top" width="15.46154615461546%" headers="mcps1.2.5.1.1 "><p id="p16142652374"><a name="p16142652374"></a><a name="p16142652374"></a>type</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.2 "><p id="p1214265217719"><a name="p1214265217719"></a><a name="p1214265217719"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.3 "><p id="p614215523715"><a name="p614215523715"></a><a name="p614215523715"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="57.73577357735774%" headers="mcps1.2.5.1.4 "><p id="p1628211155551"><a name="p1628211155551"></a><a name="p1628211155551"></a>证书的类型（保留字段）</p>
<a name="ul4298171535513"></a><a name="ul4298171535513"></a><ul id="ul4298171535513"><li>1：shubao证书</li><li>2：etcd证书</li></ul>
</td>
</tr>
<tr id="row415817522713"><td class="cellrowborder" valign="top" width="15.46154615461546%" headers="mcps1.2.5.1.1 "><p id="p1015812522711"><a name="p1015812522711"></a><a name="p1015812522711"></a>cert_content</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.2 "><p id="p17158252779"><a name="p17158252779"></a><a name="p17158252779"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.3 "><p id="p61581552375"><a name="p61581552375"></a><a name="p61581552375"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="57.73577357735774%" headers="mcps1.2.5.1.4 "><p id="p11158175215718"><a name="p11158175215718"></a><a name="p11158175215718"></a>证书内容</p>
<p id="p13985191311589"><a name="p13985191311589"></a><a name="p13985191311589"></a>长度为0-8092位的字符串</p>
</td>
</tr>
<tr id="row71748528712"><td class="cellrowborder" valign="top" width="15.46154615461546%" headers="mcps1.2.5.1.1 "><p id="p131742522712"><a name="p131742522712"></a><a name="p131742522712"></a>private_key</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.2 "><p id="p0174952374"><a name="p0174952374"></a><a name="p0174952374"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.3 "><p id="p1917414526714"><a name="p1917414526714"></a><a name="p1917414526714"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="57.73577357735774%" headers="mcps1.2.5.1.4 "><p id="p817485219717"><a name="p817485219717"></a><a name="p817485219717"></a>私钥内容</p>
<p id="p4282512195919"><a name="p4282512195919"></a><a name="p4282512195919"></a>长度为0-8092位的字符串</p>
</td>
</tr>
<tr id="row121749522719"><td class="cellrowborder" valign="top" width="15.46154615461546%" headers="mcps1.2.5.1.1 "><p id="p1418825217718"><a name="p1418825217718"></a><a name="p1418825217718"></a>is_default</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.2 "><p id="p161883520713"><a name="p161883520713"></a><a name="p161883520713"></a>是</p>
</td>
<td class="cellrowborder" valign="top" width="13.4013401340134%" headers="mcps1.2.5.1.3 "><p id="p141887521717"><a name="p141887521717"></a><a name="p141887521717"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="57.73577357735774%" headers="mcps1.2.5.1.4 "><div class="p" id="p17188185213720"><a name="p17188185213720"></a><a name="p17188185213720"></a>是否为缺省证书<a name="ul1264111552576"></a><a name="ul1264111552576"></a><ul id="ul1264111552576"><li>1：是</li><li>2：否</li></ul>
</div>
</td>
</tr>
</tbody>
</table>

请求消息样例：

```
curl -X PUT --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'X-Auth-Token: +VMXCx******7NK7Vw8=' -d '{"domain_name": "www.MyCompany.com","type": 1,"cert_content": "-----BEGIN CERTIFICATE-----\nMIIDojCCAooCCQCH1D*****iusfipPlA==\n-----END CERTIFICATE-----","private_key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA8q******HBf2C4g==\n-----END RSA PRIVATE KEY-----","is_default": 2}' 'https://localhost:8443/v1/{project_id}/apigw/instances/{instance_id}/certificates'
```

## 响应消息<a name="section14205952774"></a>

**表 4**  参数说明

<a name="table920515218713"></a>
<table><thead align="left"><tr id="row8205125218714"><th class="cellrowborder" valign="top" width="18.18%" id="mcps1.2.4.1.1"><p id="p0219185211710"><a name="p0219185211710"></a><a name="p0219185211710"></a>名称</p>
</th>
<th class="cellrowborder" valign="top" width="16.16%" id="mcps1.2.4.1.2"><p id="p172199523718"><a name="p172199523718"></a><a name="p172199523718"></a>类型</p>
</th>
<th class="cellrowborder" valign="top" width="65.66%" id="mcps1.2.4.1.3"><p id="p10219752077"><a name="p10219752077"></a><a name="p10219752077"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row12219752974"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p1821915521678"><a name="p1821915521678"></a><a name="p1821915521678"></a>id</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p132351452777"><a name="p132351452777"></a><a name="p132351452777"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p172357521175"><a name="p172357521175"></a><a name="p172357521175"></a>证书的编号</p>
</td>
</tr>
<tr id="row16235165210710"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p82196598110"><a name="p82196598110"></a><a name="p82196598110"></a>domain_name</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p13111613925"><a name="p13111613925"></a><a name="p13111613925"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p14236122812211"><a name="p14236122812211"></a><a name="p14236122812211"></a>域名</p>
</td>
</tr>
<tr id="row1523595217711"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p3219759619"><a name="p3219759619"></a><a name="p3219759619"></a>type</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p18111161313214"><a name="p18111161313214"></a><a name="p18111161313214"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p1323618281420"><a name="p1323618281420"></a><a name="p1323618281420"></a>证书的类型（保留字段）</p>
<a name="ul22367281725"></a><a name="ul22367281725"></a><ul id="ul22367281725"><li>1：shubao证书</li><li>2：etcd证书</li></ul>
</td>
</tr>
<tr id="row925219525714"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p321920591217"><a name="p321920591217"></a><a name="p321920591217"></a>cert_content</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p111113131323"><a name="p111113131323"></a><a name="p111113131323"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p52528287219"><a name="p52528287219"></a><a name="p52528287219"></a>证书内容</p>
</td>
</tr>
<tr id="row826613521075"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p192196591210"><a name="p192196591210"></a><a name="p192196591210"></a>private_key</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p19111113326"><a name="p19111113326"></a><a name="p19111113326"></a>String</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p2252122815217"><a name="p2252122815217"></a><a name="p2252122815217"></a>私钥内容</p>
</td>
</tr>
<tr id="row19266175213712"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p9235359515"><a name="p9235359515"></a><a name="p9235359515"></a>is_default</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p2126171312216"><a name="p2126171312216"></a><a name="p2126171312216"></a>Integer</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p1125217289214"><a name="p1125217289214"></a><a name="p1125217289214"></a>是否为缺省证书</p>
<a name="ul825292810211"></a><a name="ul825292810211"></a><ul id="ul825292810211"><li>1：是</li><li>2：否</li></ul>
</td>
</tr>
<tr id="row15282752874"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p8486173912210"><a name="p8486173912210"></a><a name="p8486173912210"></a>create_time</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p9486039925"><a name="p9486039925"></a><a name="p9486039925"></a>Timestamp</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p44864391020"><a name="p44864391020"></a><a name="p44864391020"></a>创建时间</p>
</td>
</tr>
<tr id="row629855215717"><td class="cellrowborder" valign="top" width="18.18%" headers="mcps1.2.4.1.1 "><p id="p42984527714"><a name="p42984527714"></a><a name="p42984527714"></a>update_time</p>
</td>
<td class="cellrowborder" valign="top" width="16.16%" headers="mcps1.2.4.1.2 "><p id="p6298452772"><a name="p6298452772"></a><a name="p6298452772"></a>Timestamp</p>
</td>
<td class="cellrowborder" valign="top" width="65.66%" headers="mcps1.2.4.1.3 "><p id="p8314552174"><a name="p8314552174"></a><a name="p8314552174"></a>更新时间</p>
</td>
</tr>
</tbody>
</table>

响应消息样例：

```
{
  "id": "71cf24283c3d48dda1d47ccbabbcab39",
  "create_time": "2018-07-13T12:00:23Z",
  "update_time": "2018-07-13T12:00:28Z",
  "domain_name": "www.MyCompany.com",
  "type": 2,
  "cert_content": "-----BEGIN CERTIFICATE-----\nMIIDojCCAooCCQCH1D*****iusfipPlA==\n-----END CERTIFICATE-----\n",
  "private_key": "-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA8q******HBf2C4g==\n-----END RSA PRIVATE KEY-----\n",
  "is_default": 2
}
```

## 状态码<a name="section123308529713"></a>

**表 5**  返回消息说明

<a name="table1338010302424"></a>
<table><thead align="left"><tr id="row048810308426"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.3.1.1"><p id="p174881730194216"><a name="p174881730194216"></a><a name="p174881730194216"></a>状态码</p>
</th>
<th class="cellrowborder" valign="top" width="80%" id="mcps1.2.3.1.2"><p id="p848863018429"><a name="p848863018429"></a><a name="p848863018429"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row94881130104218"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p7488163084211"><a name="p7488163084211"></a><a name="p7488163084211"></a>200</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p948803015424"><a name="p948803015424"></a><a name="p948803015424"></a>OK</p>
</td>
</tr>
<tr id="row1948893004211"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p14488113015426"><a name="p14488113015426"></a><a name="p14488113015426"></a>400</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p164881130154211"><a name="p164881130154211"></a><a name="p164881130154211"></a>Bad Request</p>
</td>
</tr>
<tr id="row1488230194211"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p6488133064210"><a name="p6488133064210"></a><a name="p6488133064210"></a>403</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p10488193018426"><a name="p10488193018426"></a><a name="p10488193018426"></a>Forbidden</p>
</td>
</tr>
<tr id="row174882030134217"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p144883304428"><a name="p144883304428"></a><a name="p144883304428"></a>404</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p4488103094212"><a name="p4488103094212"></a><a name="p4488103094212"></a>Not Found</p>
</td>
</tr>
<tr id="row5488183024215"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p17488163014423"><a name="p17488163014423"></a><a name="p17488163014423"></a>500</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p048813014216"><a name="p048813014216"></a><a name="p048813014216"></a>Server Internal Error</p>
</td>
</tr>
</tbody>
</table>

