# 请求签名流程<a name="apig-zh-api-180713007"></a>

## 签名前的准备<a name="section60405453144225"></a>

1.  下载API网关签名工具。
2.  解压下载的压缩包。
3.  创建java工程，将解压出来的jar引用到依赖路径中。

## 签名过程<a name="section2739684514430"></a>

1.  <a name="li66461417162047"></a>创建用于签名的请求com.cloud.sdk.DefaultRequest\(JAVA\)。
2.  设置DefaultRequest的目标API URL、HTTPS方法、内容等信息。
3.  <a name="li47248080162035"></a>对DefaultRequest进行签名：
    1.  调用SignerFactory.getSigner\(String serviceName, String regionName\)获取一个签名工具实现的实例。
    2.  调用Signer.sign\(Request<?\> request, Credentials credentials\)对[1](#li66461417162047)创建的请求进行签名。

        ```
        //选用签名算法，对请求进行签名
        Signer signer = SignerFactory.getSigner(serviceName, region);
        //对请求进行签名，request会发生改变
        signer.sign(request, new BasicCredentials(this.ak, this.sk));
        ```


4.  把[3](#li47248080162035)中签名产生的request转换为一个适合发送的请求，并将签名后request中的header信息放入新的request中。

    以Apache HttpClient为例，需要把DefaultRequest转换为HttpRequestBase，把签名后的DefaultRequest的header信息放入HttpRequestBase中。

    具体过程请参考[示例代码](示例代码.md)中的AccessServiceImpl.java中的实现。


